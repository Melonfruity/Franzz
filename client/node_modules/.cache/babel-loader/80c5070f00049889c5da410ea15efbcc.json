{"ast":null,"code":"import _regeneratorRuntime from\"/home/hei/Documents/finals/JEK/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/hei/Documents/finals/JEK/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _toConsumableArray from\"/home/hei/Documents/finals/JEK/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _defineProperty from\"/home/hei/Documents/finals/JEK/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/home/hei/Documents/finals/JEK/client/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/hei/Documents/finals/JEK/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import{LinearProgress}from'@material-ui/core';import{handleFiles}from'./Scripts/DragAndDropPhotos';export default function AlbumForm(_ref){var channelId=_ref.channelId,emitSendMessage=_ref.emitSendMessage,albumName=_ref.albumName,newAlbum=_ref.newAlbum,viewAlbum=_ref.viewAlbum;var _useState=useState({album:albumName,files:[],originalName:albumName}),_useState2=_slicedToArray(_useState,2),fields=_useState2[0],changeFields=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),showProgress=_useState4[0],toggleProgress=_useState4[1];function previewFile(file){var reader=new FileReader();reader.readAsDataURL(file);reader.onloadend=function(){var img=document.createElement('img');if(file.type==='video/mp4'){img=document.createElement('video');}img.src=reader.result;document.getElementById('input-display').appendChild(img);};}// Handles form events when adding files and\n// creating a name\nfunction handleOnChange(event){event.preventDefault();if(event.target.name==='album'){var _objectSpread2;var value=event.target.value.replace(/ /g,'-');changeFields(_objectSpread({},fields,(_objectSpread2={},_defineProperty(_objectSpread2,event.target.name,value),_defineProperty(_objectSpread2,\"originalName\",event.target.value),_objectSpread2)));}else{_toConsumableArray(event.target.files).forEach(previewFile);changeFields({album:fields.album,files:[].concat(_toConsumableArray(fields.files),[event.target.files])});}}function viewUpdatedAlbum(){var pathName=albumName.replace(/ /g,'-');console.log(pathName);viewAlbum(\"\".concat(channelId,\"/albums/\").concat(pathName),albumName);}function viewAlbums(){viewAlbum('albums');}function handleSubmit(_x){return _handleSubmit.apply(this,arguments);}function _handleSubmit(){_handleSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var message;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:toggleProgress(true);event.preventDefault();_toConsumableArray(fields.files).forEach(function(file){if(!newAlbum){handleFiles(file,channelId,fields.album,emitSendMessage,viewUpdatedAlbum);}else{handleFiles(file,channelId,fields.album,emitSendMessage,viewAlbums);}setTimeout(function(){toggleProgress(false);},3000);});document.getElementById('album-upload-form').reset();message=\"\\uD83D\\uDEA8A new album '\".concat(fields.album.replace(/-/g,' '),\"' has been uploaded\\uD83D\\uDEA8\");if(!newAlbum){message=\"\\uD83D\\uDC40 New photos were added to \".concat(fields.album);}else{setTimeout(function(){return viewAlbum('albums');},3000);}setTimeout(function(){return emitSendMessage(message,false,false);},3000);case 7:case\"end\":return _context.stop();}}},_callee);}));return _handleSubmit.apply(this,arguments);}return React.createElement(\"div\",null,showProgress&&React.createElement(LinearProgress,null),newAlbum&&React.createElement(\"div\",{className:\"popup-title\"},\"New Album\"),!newAlbum&&React.createElement(\"div\",{className:\"popup-title-mod\"},\"Adding photos to\",' ',albumName),React.createElement(\"form\",{id:\"album-upload-form\",onSubmit:handleSubmit},newAlbum&&React.createElement(\"input\",{id:\"input-album\",type:\"text\",name:\"album\",placeholder:\"Choose an album name\",onChange:handleOnChange}),React.createElement(\"div\",{id:\"album-submission\"},React.createElement(\"input\",{className:\"submit-button\",type:\"submit\",value:\"SUBMIT\"})),React.createElement(\"div\",{id:\"input-display\",value:\"drag\"},React.createElement(\"input\",{id:\"album-upload\",name:\"files\",type:\"file\",multiple:true,accept:\"image/*\",onChange:handleOnChange}),React.createElement(\"div\",{className:\"subtitle\"},\"ADDED MEDIA:\"))));}","map":{"version":3,"sources":["/home/hei/Documents/finals/JEK/client/src/components/Home/Channel/Modules/Photos/AlbumForm.js"],"names":["React","useState","LinearProgress","handleFiles","AlbumForm","channelId","emitSendMessage","albumName","newAlbum","viewAlbum","album","files","originalName","fields","changeFields","showProgress","toggleProgress","previewFile","file","reader","FileReader","readAsDataURL","onloadend","img","document","createElement","type","src","result","getElementById","appendChild","handleOnChange","event","preventDefault","target","name","value","replace","forEach","viewUpdatedAlbum","pathName","console","log","viewAlbums","handleSubmit","setTimeout","reset","message"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport { LinearProgress } from '@material-ui/core';\nimport { handleFiles } from './Scripts/DragAndDropPhotos';\n\n\nexport default function AlbumForm({\n  channelId, emitSendMessage, albumName, newAlbum, viewAlbum,\n}) {\n  const [fields, changeFields] = useState(\n    {\n      album: albumName,\n      files: [],\n      originalName: albumName,\n    },\n  );\n  const [showProgress, toggleProgress] = useState(false);\n\n  function previewFile(file) {\n    const reader = new FileReader();\n    reader.readAsDataURL(file);\n    reader.onloadend = function () {\n      let img = document.createElement('img');\n      if (file.type === 'video/mp4') {\n        img = document.createElement('video');\n      }\n      img.src = reader.result;\n      document.getElementById('input-display').appendChild(img);\n    };\n  }\n\n  // Handles form events when adding files and\n  // creating a name\n  function handleOnChange(event) {\n    event.preventDefault();\n    if (event.target.name === 'album') {\n      const value = event.target.value.replace(/ /g, '-');\n      changeFields({\n        ...fields,\n        [event.target.name]: value,\n        originalName: event.target.value,\n      });\n    } else {\n      [...event.target.files].forEach(previewFile);\n      changeFields({\n        album: fields.album,\n        files: [...fields.files, event.target.files],\n      });\n    }\n  }\n\n  function viewUpdatedAlbum() {\n    const pathName = albumName.replace(/ /g, '-');\n    console.log(pathName)\n    viewAlbum(`${channelId}/albums/${pathName}`, albumName);\n  }\n\n  function viewAlbums() {\n    viewAlbum('albums');\n  }\n\n  async function handleSubmit(event) {\n    toggleProgress(true);\n    event.preventDefault();\n    [...fields.files].forEach((file) => {\n      if (!newAlbum) {\n        handleFiles(file, channelId, fields.album, emitSendMessage, viewUpdatedAlbum);\n      } else {\n        handleFiles(file, channelId, fields.album, emitSendMessage, viewAlbums);\n      }\n      setTimeout(() => {\n        toggleProgress(false);\n      }, 3000);\n    });\n    document.getElementById('album-upload-form').reset();\n    let message = `ðŸš¨A new album '${fields.album.replace(/-/g, ' ')}' has been uploadedðŸš¨`;\n    if (!newAlbum) {\n      message = `ðŸ‘€ New photos were added to ${fields.album}`;\n    } else {\n      setTimeout(() => viewAlbum('albums'), 3000);\n    }\n    setTimeout(() => emitSendMessage(message, false, false), 3000);\n  }\n\n  return (\n    <div>\n      { showProgress && <LinearProgress /> }\n      { newAlbum && <div className=\"popup-title\">New Album</div> }\n      { !newAlbum && (\n      <div className=\"popup-title-mod\">\n        Adding photos to\n        {' '}\n        {albumName}\n      </div>\n      )}\n      <form id=\"album-upload-form\" onSubmit={handleSubmit}>\n        { newAlbum && (\n          <input id=\"input-album\" type=\"text\" name=\"album\" placeholder=\"Choose an album name\" onChange={handleOnChange} />\n        )}\n        <div id=\"album-submission\"><input className=\"submit-button\" type=\"submit\" value=\"SUBMIT\" /></div>\n        <div id=\"input-display\" value=\"drag\">\n          <input\n            id=\"album-upload\"\n            name=\"files\"\n            type=\"file\"\n            multiple\n            accept=\"image/*\"\n            onChange={handleOnChange}\n          />\n          <div className=\"subtitle\">ADDED MEDIA:</div>\n        </div>\n      </form>\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}